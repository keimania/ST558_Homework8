---
title: "ST558 Homework8"
format: html
editor: visual
---

# Jamin Goo (NCSU id : jgoo)

```{r}
#| message: FALSE
#| warning: FALSE

# Load necessary libraries
library(tidyverse)
library(tidymodels)
library(lubridate)
library(janitor)
```

## 1. Reading Data

```{r}
bike_data_raw <- read_csv("SeoulBikeData.csv", 
                          locale = locale(encoding = "latin1"))
```

## 2. EDA

### Checking the Data

```{r}
# 1. Check for missingness
print(colSums(is.na(bike_data_raw)))
```

All columns are 0 : There is no missing.

```{r}
# 2. Check column types and values
glimpse(bike_data_raw)
summary(bike_data_raw |> select(where(is.numeric)))
print(map(bike_data_raw |> select(where(is.character), -Date), unique))
```

```{r}
# 3, 4, 5. Convert Date, Convert to Factors, Rename
bike_data_cleaned <- bike_data_raw |>
  mutate(
    Date = dmy(Date), # 3. Convert the Date column into an actual date 
    Seasons = factor(Seasons), # 4: Turn the character variables 
    Holiday = factor(Holiday), # 4: Turn the character variables 
  ) |>
  clean_names() |> # 5: Rename all the variables to have easy to use names 
  mutate(
    functioning_day = factor(functioning_day) # 4: Turn the character variables 
  )

glimpse(bike_data_cleaned)
```

2.  

```{r}
# 6: Create summary statistics (especially related to the bike rental count)
print(
  bike_data_cleaned |>
    group_by(functioning_day) |>
    summarize(
      count = n(),
      min_bikes = min(rented_bike_count),
      mean_bikes = mean(rented_bike_count),
      max_bikes = max(rented_bike_count)
    )
)

# 6: Subset the data appropriately
bike_data_functional <- bike_data_cleaned |>
  filter(functioning_day == "Yes")

summary(bike_data_functional)

bike_data_functional_no <- bike_data_cleaned |>
  filter(functioning_day == "No")

summary(bike_data_functional_no)
```

If the bike is not functioning, the rented bike count is always 0.

So we will focus on the data where the bike is functioning for further analysis.

```{r}
# 7: To simplify our analysis, weâ€™ll summarize across the hours
bike_data_daily <- bike_data_functional |>
  group_by(date, seasons, holiday) |>
  summarize(
    # Find the sum of rented_bike_count, rainfall, and snowfall
    rented_bike_count_sum = sum(rented_bike_count),
    rainfall_sum_mm = sum(rainfall_mm),
    snowfall_sum_cm = sum(snowfall_cm),
    
    # Find the mean of all the weather related variables
    temperature_mean_c = mean(temperature_c),
    humidity_mean_percent = mean(humidity_percent),
    wind_speed_mean_m_s = mean(wind_speed_m_s),
    visibility_mean_10m = mean(visibility_10m),
    dew_point_temperature_mean_c = mean(dew_point_temperature_c),
    solar_radiation_mean_mj_m2 = mean(solar_radiation_mj_m2),
    
    .groups = 'drop' 
  )

glimpse(bike_data_daily)
```

```{r}
# 8: Recreate my basic summary stats
summary(bike_data_daily)

# Plot: Rented Bike Count vs. Mean Temperature
plot_temp <- bike_data_daily |>
  ggplot(aes(x = temperature_mean_c , y = rented_bike_count_sum)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(
    title = "Daily Bike Rentals vs. Mean Temperature",
    x = "Mean Temperature (C)",
    y = "Sum of Daily Bike Rentals"
  )
print(plot_temp)

#  correlation between my numeric variables
cor_matrix <- bike_data_daily |>
  select(where(is.numeric)) |>
  cor()
print(round(cor_matrix, 2))
```
