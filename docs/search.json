[
  {
    "objectID": "Homework8.html",
    "href": "Homework8.html",
    "title": "ST558 Homework8",
    "section": "",
    "text": "# Load necessary libraries\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(lubridate)\nlibrary(janitor)\n\n\n\n\nbike_data_raw &lt;- read_csv(\"SeoulBikeData.csv\", \n                          locale = locale(encoding = \"latin1\"))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\n\n\n\n# 1. Check for missingness\nprint(colSums(is.na(bike_data_raw)))\n\n                      Date          Rented Bike Count \n                         0                          0 \n                      Hour           Temperature(°C) \n                         0                          0 \n               Humidity(%)           Wind speed (m/s) \n                         0                          0 \n          Visibility (10m) Dew point temperature(°C) \n                         0                          0 \n   Solar Radiation (MJ/m2)               Rainfall(mm) \n                         0                          0 \n             Snowfall (cm)                    Seasons \n                         0                          0 \n                   Holiday            Functioning Day \n                         0                          0 \n\n\nAll columns are 0 : There is no missing.\n\n# 2. Check column types and values\nglimpse(bike_data_raw)\n\nRows: 8,760\nColumns: 14\n$ Date                        &lt;chr&gt; \"01/12/2017\", \"01/12/2017\", \"01/12/2017\", …\n$ `Rented Bike Count`         &lt;dbl&gt; 254, 204, 173, 107, 78, 100, 181, 460, 930…\n$ Hour                        &lt;dbl&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, …\n$ `Temperature(°C)`           &lt;dbl&gt; -5.2, -5.5, -6.0, -6.2, -6.0, -6.4, -6.6, …\n$ `Humidity(%)`               &lt;dbl&gt; 37, 38, 39, 40, 36, 37, 35, 38, 37, 27, 24…\n$ `Wind speed (m/s)`          &lt;dbl&gt; 2.2, 0.8, 1.0, 0.9, 2.3, 1.5, 1.3, 0.9, 1.…\n$ `Visibility (10m)`          &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, …\n$ `Dew point temperature(°C)` &lt;dbl&gt; -17.6, -17.6, -17.7, -17.6, -18.6, -18.7, …\n$ `Solar Radiation (MJ/m2)`   &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, …\n$ `Rainfall(mm)`              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ `Snowfall (cm)`             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Seasons                     &lt;chr&gt; \"Winter\", \"Winter\", \"Winter\", \"Winter\", \"W…\n$ Holiday                     &lt;chr&gt; \"No Holiday\", \"No Holiday\", \"No Holiday\", …\n$ `Functioning Day`           &lt;chr&gt; \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …\n\nsummary(bike_data_raw |&gt; select(where(is.numeric)))\n\n Rented Bike Count      Hour       Temperature(°C)  Humidity(%)   \n Min.   :   0.0    Min.   : 0.00   Min.   :-17.80   Min.   : 0.00  \n 1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50   1st Qu.:42.00  \n Median : 504.5    Median :11.50   Median : 13.70   Median :57.00  \n Mean   : 704.6    Mean   :11.50   Mean   : 12.88   Mean   :58.23  \n 3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50   3rd Qu.:74.00  \n Max.   :3556.0    Max.   :23.00   Max.   : 39.40   Max.   :98.00  \n Wind speed (m/s) Visibility (10m) Dew point temperature(°C)\n Min.   :0.000    Min.   :  27     Min.   :-30.600           \n 1st Qu.:0.900    1st Qu.: 940     1st Qu.: -4.700           \n Median :1.500    Median :1698     Median :  5.100           \n Mean   :1.725    Mean   :1437     Mean   :  4.074           \n 3rd Qu.:2.300    3rd Qu.:2000     3rd Qu.: 14.800           \n Max.   :7.400    Max.   :2000     Max.   : 27.200           \n Solar Radiation (MJ/m2)  Rainfall(mm)     Snowfall (cm)    \n Min.   :0.0000          Min.   : 0.0000   Min.   :0.00000  \n 1st Qu.:0.0000          1st Qu.: 0.0000   1st Qu.:0.00000  \n Median :0.0100          Median : 0.0000   Median :0.00000  \n Mean   :0.5691          Mean   : 0.1487   Mean   :0.07507  \n 3rd Qu.:0.9300          3rd Qu.: 0.0000   3rd Qu.:0.00000  \n Max.   :3.5200          Max.   :35.0000   Max.   :8.80000  \n\nprint(map(bike_data_raw |&gt; select(where(is.character), -Date), unique))\n\n$Seasons\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\n$Holiday\n[1] \"No Holiday\" \"Holiday\"   \n\n$`Functioning Day`\n[1] \"Yes\" \"No\" \n\n\n\n# 3, 4, 5. Convert Date, Convert to Factors, Rename\nbike_data_cleaned &lt;- bike_data_raw |&gt;\n  mutate(\n    Date = dmy(Date), # 3. Convert the Date column into an actual date \n    Seasons = factor(Seasons), # 4: Turn the character variables \n    Holiday = factor(Holiday), # 4: Turn the character variables \n  ) |&gt;\n  clean_names() |&gt; # 5: Rename all the variables to have easy to use names \n  mutate(\n    functioning_day = factor(functioning_day) # 4: Turn the character variables \n  )\n\nglimpse(bike_data_cleaned)\n\nRows: 8,760\nColumns: 14\n$ date                    &lt;date&gt; 2017-12-01, 2017-12-01, 2017-12-01, 2017-12-0…\n$ rented_bike_count       &lt;dbl&gt; 254, 204, 173, 107, 78, 100, 181, 460, 930, 49…\n$ hour                    &lt;dbl&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, …\n$ temperature_c           &lt;dbl&gt; -5.2, -5.5, -6.0, -6.2, -6.0, -6.4, -6.6, -7.4…\n$ humidity_percent        &lt;dbl&gt; 37, 38, 39, 40, 36, 37, 35, 38, 37, 27, 24, 21…\n$ wind_speed_m_s          &lt;dbl&gt; 2.2, 0.8, 1.0, 0.9, 2.3, 1.5, 1.3, 0.9, 1.1, 0…\n$ visibility_10m          &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000…\n$ dew_point_temperature_c &lt;dbl&gt; -17.6, -17.6, -17.7, -17.6, -18.6, -18.7, -19.…\n$ solar_radiation_mj_m2   &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00…\n$ rainfall_mm             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ snowfall_cm             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons                 &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, Winter…\n$ holiday                 &lt;fct&gt; No Holiday, No Holiday, No Holiday, No Holiday…\n$ functioning_day         &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Y…\n\n\n\n\n\n\n# 6: Create summary statistics (especially related to the bike rental count)\nprint(\n  bike_data_cleaned |&gt;\n    group_by(functioning_day) |&gt;\n    summarize(\n      count = n(),\n      min_bikes = min(rented_bike_count),\n      mean_bikes = mean(rented_bike_count),\n      max_bikes = max(rented_bike_count)\n    )\n)\n\n# A tibble: 2 × 5\n  functioning_day count min_bikes mean_bikes max_bikes\n  &lt;fct&gt;           &lt;int&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;\n1 No                295         0         0          0\n2 Yes              8465         2       729.      3556\n\n# 6: Subset the data appropriately\nbike_data_functional &lt;- bike_data_cleaned |&gt;\n  filter(functioning_day == \"Yes\")\n\nsummary(bike_data_functional)\n\n      date            rented_bike_count      hour       temperature_c   \n Min.   :2017-12-01   Min.   :   2.0    Min.   : 0.00   Min.   :-17.80  \n 1st Qu.:2018-02-27   1st Qu.: 214.0    1st Qu.: 6.00   1st Qu.:  3.00  \n Median :2018-05-28   Median : 542.0    Median :12.00   Median : 13.50  \n Mean   :2018-05-28   Mean   : 729.2    Mean   :11.51   Mean   : 12.77  \n 3rd Qu.:2018-08-24   3rd Qu.:1084.0    3rd Qu.:18.00   3rd Qu.: 22.70  \n Max.   :2018-11-30   Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n humidity_percent wind_speed_m_s  visibility_10m dew_point_temperature_c\n Min.   : 0.00    Min.   :0.000   Min.   :  27   Min.   :-30.600        \n 1st Qu.:42.00    1st Qu.:0.900   1st Qu.: 935   1st Qu.: -5.100        \n Median :57.00    Median :1.500   Median :1690   Median :  4.700        \n Mean   :58.15    Mean   :1.726   Mean   :1434   Mean   :  3.945        \n 3rd Qu.:74.00    3rd Qu.:2.300   3rd Qu.:2000   3rd Qu.: 15.200        \n Max.   :98.00    Max.   :7.400   Max.   :2000   Max.   : 27.200        \n solar_radiation_mj_m2  rainfall_mm       snowfall_cm        seasons    \n Min.   :0.0000        Min.   : 0.0000   Min.   :0.00000   Autumn:1937  \n 1st Qu.:0.0000        1st Qu.: 0.0000   1st Qu.:0.00000   Spring:2160  \n Median :0.0100        Median : 0.0000   Median :0.00000   Summer:2208  \n Mean   :0.5679        Mean   : 0.1491   Mean   :0.07768   Winter:2160  \n 3rd Qu.:0.9300        3rd Qu.: 0.0000   3rd Qu.:0.00000                \n Max.   :3.5200        Max.   :35.0000   Max.   :8.80000                \n       holiday     functioning_day\n Holiday   : 408   No :   0       \n No Holiday:8057   Yes:8465       \n                                  \n                                  \n                                  \n                                  \n\nbike_data_functional_no &lt;- bike_data_cleaned |&gt;\n  filter(functioning_day == \"No\")\n\nsummary(bike_data_functional_no)\n\n      date            rented_bike_count      hour      temperature_c  \n Min.   :2018-04-11   Min.   :0         Min.   : 0.0   Min.   : 5.20  \n 1st Qu.:2018-09-19   1st Qu.:0         1st Qu.: 5.0   1st Qu.:12.30  \n Median :2018-10-02   Median :0         Median :11.0   Median :16.30  \n Mean   :2018-09-12   Mean   :0         Mean   :11.3   Mean   :16.09  \n 3rd Qu.:2018-10-09   3rd Qu.:0         3rd Qu.:17.0   3rd Qu.:19.35  \n Max.   :2018-11-09   Max.   :0         Max.   :23.0   Max.   :26.50  \n humidity_percent wind_speed_m_s  visibility_10m dew_point_temperature_c\n Min.   :21.00    Min.   :0.000   Min.   : 201   Min.   :-7.00          \n 1st Qu.:49.00    1st Qu.:0.900   1st Qu.:1055   1st Qu.: 5.30          \n Median :62.00    Median :1.500   Median :1814   Median : 7.80          \n Mean   :60.49    Mean   :1.697   Mean   :1522   Mean   : 7.77          \n 3rd Qu.:73.00    3rd Qu.:2.350   3rd Qu.:2000   3rd Qu.:11.00          \n Max.   :96.00    Max.   :5.300   Max.   :2000   Max.   :16.10          \n solar_radiation_mj_m2  rainfall_mm       snowfall_cm   seasons   \n Min.   :0.0000        Min.   : 0.0000   Min.   :0    Autumn:247  \n 1st Qu.:0.0000        1st Qu.: 0.0000   1st Qu.:0    Spring: 48  \n Median :0.0000        Median : 0.0000   Median :0    Summer:  0  \n Mean   :0.6048        Mean   : 0.1363   Mean   :0    Winter:  0  \n 3rd Qu.:1.0650        3rd Qu.: 0.0000   3rd Qu.:0                \n Max.   :3.3200        Max.   :18.0000   Max.   :0                \n       holiday    functioning_day\n Holiday   : 24   No :295        \n No Holiday:271   Yes:  0        \n                                 \n                                 \n                                 \n                                 \n\n\nIf the bike is not functioning, the rented bike count is always 0.\nSo we will focus on the data where the bike is functioning for further analysis.\n\n# 7: To simplify our analysis, we’ll summarize across the hours\nbike_data_daily &lt;- bike_data_functional |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(\n    # Find the sum of rented_bike_count, rainfall, and snowfall\n    rented_bike_count_sum = sum(rented_bike_count),\n    rainfall_sum_mm = sum(rainfall_mm),\n    snowfall_sum_cm = sum(snowfall_cm),\n    \n    # Find the mean of all the weather related variables\n    temperature_mean_c = mean(temperature_c),\n    humidity_mean_percent = mean(humidity_percent),\n    wind_speed_mean_m_s = mean(wind_speed_m_s),\n    visibility_mean_10m = mean(visibility_10m),\n    dew_point_temperature_mean_c = mean(dew_point_temperature_c),\n    solar_radiation_mean_mj_m2 = mean(solar_radiation_mj_m2),\n    \n    .groups = 'drop' \n  )\n\nglimpse(bike_data_daily)\n\nRows: 353\nColumns: 12\n$ date                         &lt;date&gt; 2017-12-01, 2017-12-02, 2017-12-03, 2017…\n$ seasons                      &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, W…\n$ holiday                      &lt;fct&gt; No Holiday, No Holiday, No Holiday, No Ho…\n$ rented_bike_count_sum        &lt;dbl&gt; 9539, 8523, 7222, 8729, 8307, 6669, 8549,…\n$ rainfall_sum_mm              &lt;dbl&gt; 0.0, 0.0, 4.0, 0.1, 0.0, 1.3, 0.0, 0.0, 0…\n$ snowfall_sum_cm              &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 8.6, 10.4, 0.0, …\n$ temperature_mean_c           &lt;dbl&gt; -2.45416667, 1.32500000, 4.87500000, -0.3…\n$ humidity_mean_percent        &lt;dbl&gt; 45.87500, 61.95833, 81.54167, 52.50000, 3…\n$ wind_speed_mean_m_s          &lt;dbl&gt; 1.5375000, 1.7125000, 1.6125000, 3.450000…\n$ visibility_mean_10m          &lt;dbl&gt; 1870.7500, 1471.0833, 455.7500, 1362.8333…\n$ dew_point_temperature_mean_c &lt;dbl&gt; -13.5458333, -5.7166667, 1.8833333, -9.92…\n$ solar_radiation_mean_mj_m2   &lt;dbl&gt; 0.24875000, 0.26375000, 0.12541667, 0.282…\n\n\n\n# 8: Recreate my basic summary stats\nsummary(bike_data_daily)\n\n      date              seasons         holiday    rented_bike_count_sum\n Min.   :2017-12-01   Autumn:81   Holiday   : 17   Min.   :  977        \n 1st Qu.:2018-02-27   Spring:90   No Holiday:336   1st Qu.: 6967        \n Median :2018-05-28   Summer:92                    Median :18563        \n Mean   :2018-05-28   Winter:90                    Mean   :17485        \n 3rd Qu.:2018-08-24                                3rd Qu.:26285        \n Max.   :2018-11-30                                Max.   :36149        \n rainfall_sum_mm  snowfall_sum_cm  temperature_mean_c humidity_mean_percent\n Min.   : 0.000   Min.   : 0.000   Min.   :-14.738    Min.   :22.25        \n 1st Qu.: 0.000   1st Qu.: 0.000   1st Qu.:  3.304    1st Qu.:47.58        \n Median : 0.000   Median : 0.000   Median : 13.738    Median :57.17        \n Mean   : 3.576   Mean   : 1.863   Mean   : 12.776    Mean   :58.17        \n 3rd Qu.: 0.500   3rd Qu.: 0.000   3rd Qu.: 22.592    3rd Qu.:67.71        \n Max.   :95.500   Max.   :78.700   Max.   : 33.742    Max.   :95.88        \n wind_speed_mean_m_s visibility_mean_10m dew_point_temperature_mean_c\n Min.   :0.6625      Min.   : 214.3      Min.   :-27.750             \n 1st Qu.:1.3042      1st Qu.:1087.0      1st Qu.: -5.188             \n Median :1.6583      Median :1557.8      Median :  4.612             \n Mean   :1.7261      Mean   :1434.0      Mean   :  3.954             \n 3rd Qu.:1.9542      3rd Qu.:1874.3      3rd Qu.: 14.921             \n Max.   :4.0000      Max.   :2000.0      Max.   : 25.038             \n solar_radiation_mean_mj_m2\n Min.   :0.02917           \n 1st Qu.:0.28333           \n Median :0.56500           \n Mean   :0.56773           \n 3rd Qu.:0.82000           \n Max.   :1.21667           \n\n# Plot: Rented Bike Count vs. Mean Temperature\nplot_temp &lt;- bike_data_daily |&gt;\n  ggplot(aes(x = temperature_mean_c , y = rented_bike_count_sum)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n  labs(\n    title = \"Daily Bike Rentals vs. Mean Temperature\",\n    x = \"Mean Temperature (C)\",\n    y = \"Sum of Daily Bike Rentals\"\n  )\nprint(plot_temp)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n#  correlation between my numeric variables\ncor_matrix &lt;- bike_data_daily |&gt;\n  select(where(is.numeric)) |&gt;\n  cor()\nprint(round(cor_matrix, 2))\n\n                             rented_bike_count_sum rainfall_sum_mm\nrented_bike_count_sum                         1.00           -0.24\nrainfall_sum_mm                              -0.24            1.00\nsnowfall_sum_cm                              -0.27           -0.02\ntemperature_mean_c                            0.75            0.14\nhumidity_mean_percent                         0.04            0.53\nwind_speed_mean_m_s                          -0.19           -0.10\nvisibility_mean_10m                           0.17           -0.22\ndew_point_temperature_mean_c                  0.65            0.26\nsolar_radiation_mean_mj_m2                    0.74           -0.32\n                             snowfall_sum_cm temperature_mean_c\nrented_bike_count_sum                  -0.27               0.75\nrainfall_sum_mm                        -0.02               0.14\nsnowfall_sum_cm                         1.00              -0.27\ntemperature_mean_c                     -0.27               1.00\nhumidity_mean_percent                   0.07               0.40\nwind_speed_mean_m_s                     0.02              -0.26\nvisibility_mean_10m                    -0.10               0.00\ndew_point_temperature_mean_c           -0.21               0.96\nsolar_radiation_mean_mj_m2             -0.23               0.55\n                             humidity_mean_percent wind_speed_mean_m_s\nrented_bike_count_sum                         0.04               -0.19\nrainfall_sum_mm                               0.53               -0.10\nsnowfall_sum_cm                               0.07                0.02\ntemperature_mean_c                            0.40               -0.26\nhumidity_mean_percent                         1.00               -0.23\nwind_speed_mean_m_s                          -0.23                1.00\nvisibility_mean_10m                          -0.56                0.21\ndew_point_temperature_mean_c                  0.63               -0.29\nsolar_radiation_mean_mj_m2                   -0.27                0.10\n                             visibility_mean_10m dew_point_temperature_mean_c\nrented_bike_count_sum                       0.17                         0.65\nrainfall_sum_mm                            -0.22                         0.26\nsnowfall_sum_cm                            -0.10                        -0.21\ntemperature_mean_c                          0.00                         0.96\nhumidity_mean_percent                      -0.56                         0.63\nwind_speed_mean_m_s                         0.21                        -0.29\nvisibility_mean_10m                         1.00                        -0.15\ndew_point_temperature_mean_c               -0.15                         1.00\nsolar_radiation_mean_mj_m2                  0.27                         0.38\n                             solar_radiation_mean_mj_m2\nrented_bike_count_sum                              0.74\nrainfall_sum_mm                                   -0.32\nsnowfall_sum_cm                                   -0.23\ntemperature_mean_c                                 0.55\nhumidity_mean_percent                             -0.27\nwind_speed_mean_m_s                                0.10\nvisibility_mean_10m                                0.27\ndew_point_temperature_mean_c                       0.38\nsolar_radiation_mean_mj_m2                         1.00\n\n\n\n\n\n\n\nset.seed(10)\nbike_split &lt;- initial_split(bike_data_daily, prop = 0.75, strata = seasons)\nbike_train &lt;- training(bike_split)\nbike_test &lt;- testing(bike_split)\nbike_CV_folds &lt;- vfold_cv(bike_train, v = 10, strata = seasons)\n\n\n\n\nCreate some recipes.\n\nMLR_recipe1 &lt;- recipe(rented_bike_count_sum ~ ., data = bike_train) |&gt;\n  # Ignore the date variable for modeling\n  step_date(date, features = c(\"dow\")) |&gt;\n  step_mutate(day_type = factor(if_else(date_dow %in% c(\"Sat\", \"Sun\"), \n                                        \"weekend\", \"weekday\"))) |&gt;\n  step_rm(date, date_dow) |&gt; \n  # Standardize the numeric variables since their scales are pretty different.\n  step_normalize(all_numeric_predictors()) |&gt;\n  # Create dummy variables for the seasons, holiday, and our new day type variable\n  step_dummy(all_nominal_predictors())\n\n# recipe 2: 1.Do the same steps as above.\nMLR_recipe2 &lt;- MLR_recipe1 |&gt;\n  # Addin interactions between seasons and holiday, seasons and temp, temp and rainfall.\n  step_interact(~ starts_with(\"seasons_\"):starts_with(\"holiday_\")) |&gt;\n  step_interact(~ starts_with(\"seasons_\"):temperature_mean_c) |&gt;\n  step_interact(~ temperature_mean_c:rainfall_sum_mm)\n\n# recipe 3: 1.Do the same steps as the 2nd recipe.\nMLR_recipe3 &lt;- MLR_recipe2 |&gt;\n  # Add in quadratic terms for each numeric predictor\n  step_poly(\n    rainfall_sum_mm, snowfall_sum_cm, temperature_mean_c, humidity_mean_percent,\n    wind_speed_mean_m_s, visibility_mean_10m, dew_point_temperature_mean_c,\n    solar_radiation_mean_mj_m2,\n    degree = 2\n  )\n\nSet up our linear model fit to use the “lm” engine.\n\nMLR_spec &lt;- linear_reg() |&gt;\n  set_engine(\"lm\") \n\n\nMLR_wkf1 &lt;- workflow() |&gt;\n  add_recipe(MLR_recipe1) |&gt;\n  add_model(MLR_spec)\nMLR_wkf2 &lt;- workflow() |&gt;\n  add_recipe(MLR_recipe2) |&gt;\n  add_model(MLR_spec)\nMLR_wkf3 &lt;- workflow() |&gt;\n  add_recipe(MLR_recipe3) |&gt;\n  add_model(MLR_spec)\n\nFit the models using 10 fold CV via fit_resamples()\n\nMLR_fit1 &lt;-  MLR_wkf1 |&gt;\n  fit_resamples(bike_CV_folds)\nMLR_fit2 &lt;- MLR_wkf2 |&gt;\n  fit_resamples(bike_CV_folds)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x2\n\n\nThere were issues with some computations   A: x3\n\n\nThere were issues with some computations   A: x4\n\n\n\n\nMLR_fit3 &lt;- MLR_wkf3 |&gt;\n  fit_resamples(bike_CV_folds)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x2\n\n\nThere were issues with some computations   A: x3\n\n\nThere were issues with some computations   A: x4\n\n\n\n\ncv_rmse_summary &lt;- rbind(\n    MLR_fit1 |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\"),\n    MLR_fit2 |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\"),\n    MLR_fit3 |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\")\n  ) |&gt; \n  mutate(Model = c(\"Model 1\", \"Model 2\", \"Model 3\")) |&gt;\n  select(Model, mean, n, std_err)\n\n# Print the final RMSE summary\nprint(cv_rmse_summary)\n\n# A tibble: 3 × 4\n  Model    mean     n std_err\n  &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;\n1 Model 1 4356.    10    148.\n2 Model 2 3045.    10    342.\n3 Model 3 2988.    10    339.\n\n\nFrom CV results, Model 3 had the lowest RMSE (≈ 2987.662). So it is selected as the best model.\n\nlowest_rmse &lt;- MLR_wkf3\n\n# Obtain final model on the test set\nfinal_model &lt;- lowest_rmse |&gt;\n  last_fit(bike_split)\n\n# Compute the RMSE metric on the test set\ntest_set_metrics &lt;- final_model |&gt;\n  collect_metrics()\n\nprint(test_set_metrics)\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config        \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard   11843.    pre0_mod0_post0\n2 rsq     standard       0.464 pre0_mod0_post0\n\n\nObtain the final model coefficient table\n\n# coefficient table using extract_fit_parsnip() and tidy()\ncoefficient_table &lt;- final_model |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()\n  \n# Print the coefficient table\nprint(coefficient_table, n=40)\n\n# A tibble: 32 × 5\n   term                                    estimate std.error statistic  p.value\n   &lt;chr&gt;                                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)                               15758.     1618.     9.74  5.36e-19\n 2 seasons_Spring                           -38052.    12303.    -3.09  2.23e- 3\n 3 seasons_Summer                            20237.     7345.     2.76  6.34e- 3\n 4 seasons_Winter                             6924.     6961.     0.995 3.21e- 1\n 5 holiday_No.Holiday                         5596.     1464.     3.82  1.70e- 4\n 6 day_type_weekend                          -2457.      389.    -6.31  1.37e- 9\n 7 seasons_Spring_x_holiday_No.Holiday       34072.    12319.     2.77  6.14e- 3\n 8 seasons_Summer_x_holiday_No.Holiday       -3743.     7256.    -0.516 6.06e- 1\n 9 seasons_Winter_x_holiday_No.Holiday      -18636.     6872.    -2.71  7.19e- 3\n10 seasons_Spring_x_temperature_mean_c       71162.    22145.     3.21  1.50e- 3\n11 seasons_Summer_x_temperature_mean_c      -17542.     5893.    -2.98  3.22e- 3\n12 seasons_Winter_x_temperature_mean_c        7070.     6282.     1.13  2.62e- 1\n13 seasons_Spring_x_holiday_No.Holiday_x_…  -65517.    22173.    -2.95  3.45e- 3\n14 seasons_Summer_x_holiday_No.Holiday_x_…    1638.     5555.     0.295 7.68e- 1\n15 seasons_Winter_x_holiday_No.Holiday_x_…  -13176.     5902.    -2.23  2.65e- 2\n16 temperature_mean_c_x_rainfall_sum_mm      -1596.      438.    -3.64  3.35e- 4\n17 rainfall_sum_mm_poly_1                   -23034.     5798.    -3.97  9.49e- 5\n18 rainfall_sum_mm_poly_2                     7002.     3105.     2.25  2.51e- 2\n19 snowfall_sum_cm_poly_1                    -2769.     3230.    -0.857 3.92e- 1\n20 snowfall_sum_cm_poly_2                     -491.     3012.    -0.163 8.71e- 1\n21 temperature_mean_c_poly_1                -11324.    66355.    -0.171 8.65e- 1\n22 temperature_mean_c_poly_2                -25949.    17339.    -1.50  1.36e- 1\n23 humidity_mean_percent_poly_1             -44599.    23294.    -1.91  5.68e- 2\n24 humidity_mean_percent_poly_2              -4353.     5925.    -0.735 4.63e- 1\n25 wind_speed_mean_m_s_poly_1                -7337.     3370.    -2.18  3.05e- 2\n26 wind_speed_mean_m_s_poly_2                 4213.     3081.     1.37  1.73e- 1\n27 visibility_mean_10m_poly_1                 7010.     4461.     1.57  1.17e- 1\n28 visibility_mean_10m_poly_2                -2906.     3147.    -0.923 3.57e- 1\n29 dew_point_temperature_mean_c_poly_1      125266.    76884.     1.63  1.05e- 1\n30 dew_point_temperature_mean_c_poly_2       -2844.    11553.    -0.246 8.06e- 1\n31 solar_radiation_mean_mj_m2_poly_1         44949.     5907.     7.61  6.96e-13\n32 solar_radiation_mean_mj_m2_poly_2         -9924.     3467.    -2.86  4.59e- 3"
  },
  {
    "objectID": "Homework8.html#reading-data",
    "href": "Homework8.html#reading-data",
    "title": "ST558 Homework8",
    "section": "",
    "text": "bike_data_raw &lt;- read_csv(\"SeoulBikeData.csv\", \n                          locale = locale(encoding = \"latin1\"))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "Homework8.html#eda",
    "href": "Homework8.html#eda",
    "title": "ST558 Homework8",
    "section": "",
    "text": "# 1. Check for missingness\nprint(colSums(is.na(bike_data_raw)))\n\n                      Date          Rented Bike Count \n                         0                          0 \n                      Hour           Temperature(°C) \n                         0                          0 \n               Humidity(%)           Wind speed (m/s) \n                         0                          0 \n          Visibility (10m) Dew point temperature(°C) \n                         0                          0 \n   Solar Radiation (MJ/m2)               Rainfall(mm) \n                         0                          0 \n             Snowfall (cm)                    Seasons \n                         0                          0 \n                   Holiday            Functioning Day \n                         0                          0 \n\n\nAll columns are 0 : There is no missing.\n\n# 2. Check column types and values\nglimpse(bike_data_raw)\n\nRows: 8,760\nColumns: 14\n$ Date                        &lt;chr&gt; \"01/12/2017\", \"01/12/2017\", \"01/12/2017\", …\n$ `Rented Bike Count`         &lt;dbl&gt; 254, 204, 173, 107, 78, 100, 181, 460, 930…\n$ Hour                        &lt;dbl&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, …\n$ `Temperature(°C)`           &lt;dbl&gt; -5.2, -5.5, -6.0, -6.2, -6.0, -6.4, -6.6, …\n$ `Humidity(%)`               &lt;dbl&gt; 37, 38, 39, 40, 36, 37, 35, 38, 37, 27, 24…\n$ `Wind speed (m/s)`          &lt;dbl&gt; 2.2, 0.8, 1.0, 0.9, 2.3, 1.5, 1.3, 0.9, 1.…\n$ `Visibility (10m)`          &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, …\n$ `Dew point temperature(°C)` &lt;dbl&gt; -17.6, -17.6, -17.7, -17.6, -18.6, -18.7, …\n$ `Solar Radiation (MJ/m2)`   &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, …\n$ `Rainfall(mm)`              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ `Snowfall (cm)`             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Seasons                     &lt;chr&gt; \"Winter\", \"Winter\", \"Winter\", \"Winter\", \"W…\n$ Holiday                     &lt;chr&gt; \"No Holiday\", \"No Holiday\", \"No Holiday\", …\n$ `Functioning Day`           &lt;chr&gt; \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …\n\nsummary(bike_data_raw |&gt; select(where(is.numeric)))\n\n Rented Bike Count      Hour       Temperature(°C)  Humidity(%)   \n Min.   :   0.0    Min.   : 0.00   Min.   :-17.80   Min.   : 0.00  \n 1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50   1st Qu.:42.00  \n Median : 504.5    Median :11.50   Median : 13.70   Median :57.00  \n Mean   : 704.6    Mean   :11.50   Mean   : 12.88   Mean   :58.23  \n 3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50   3rd Qu.:74.00  \n Max.   :3556.0    Max.   :23.00   Max.   : 39.40   Max.   :98.00  \n Wind speed (m/s) Visibility (10m) Dew point temperature(°C)\n Min.   :0.000    Min.   :  27     Min.   :-30.600           \n 1st Qu.:0.900    1st Qu.: 940     1st Qu.: -4.700           \n Median :1.500    Median :1698     Median :  5.100           \n Mean   :1.725    Mean   :1437     Mean   :  4.074           \n 3rd Qu.:2.300    3rd Qu.:2000     3rd Qu.: 14.800           \n Max.   :7.400    Max.   :2000     Max.   : 27.200           \n Solar Radiation (MJ/m2)  Rainfall(mm)     Snowfall (cm)    \n Min.   :0.0000          Min.   : 0.0000   Min.   :0.00000  \n 1st Qu.:0.0000          1st Qu.: 0.0000   1st Qu.:0.00000  \n Median :0.0100          Median : 0.0000   Median :0.00000  \n Mean   :0.5691          Mean   : 0.1487   Mean   :0.07507  \n 3rd Qu.:0.9300          3rd Qu.: 0.0000   3rd Qu.:0.00000  \n Max.   :3.5200          Max.   :35.0000   Max.   :8.80000  \n\nprint(map(bike_data_raw |&gt; select(where(is.character), -Date), unique))\n\n$Seasons\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\n$Holiday\n[1] \"No Holiday\" \"Holiday\"   \n\n$`Functioning Day`\n[1] \"Yes\" \"No\" \n\n\n\n# 3, 4, 5. Convert Date, Convert to Factors, Rename\nbike_data_cleaned &lt;- bike_data_raw |&gt;\n  mutate(\n    Date = dmy(Date), # 3. Convert the Date column into an actual date \n    Seasons = factor(Seasons), # 4: Turn the character variables \n    Holiday = factor(Holiday), # 4: Turn the character variables \n  ) |&gt;\n  clean_names() |&gt; # 5: Rename all the variables to have easy to use names \n  mutate(\n    functioning_day = factor(functioning_day) # 4: Turn the character variables \n  )\n\nglimpse(bike_data_cleaned)\n\nRows: 8,760\nColumns: 14\n$ date                    &lt;date&gt; 2017-12-01, 2017-12-01, 2017-12-01, 2017-12-0…\n$ rented_bike_count       &lt;dbl&gt; 254, 204, 173, 107, 78, 100, 181, 460, 930, 49…\n$ hour                    &lt;dbl&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, …\n$ temperature_c           &lt;dbl&gt; -5.2, -5.5, -6.0, -6.2, -6.0, -6.4, -6.6, -7.4…\n$ humidity_percent        &lt;dbl&gt; 37, 38, 39, 40, 36, 37, 35, 38, 37, 27, 24, 21…\n$ wind_speed_m_s          &lt;dbl&gt; 2.2, 0.8, 1.0, 0.9, 2.3, 1.5, 1.3, 0.9, 1.1, 0…\n$ visibility_10m          &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000…\n$ dew_point_temperature_c &lt;dbl&gt; -17.6, -17.6, -17.7, -17.6, -18.6, -18.7, -19.…\n$ solar_radiation_mj_m2   &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00…\n$ rainfall_mm             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ snowfall_cm             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ seasons                 &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, Winter…\n$ holiday                 &lt;fct&gt; No Holiday, No Holiday, No Holiday, No Holiday…\n$ functioning_day         &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Y…\n\n\n\n\n\n\n# 6: Create summary statistics (especially related to the bike rental count)\nprint(\n  bike_data_cleaned |&gt;\n    group_by(functioning_day) |&gt;\n    summarize(\n      count = n(),\n      min_bikes = min(rented_bike_count),\n      mean_bikes = mean(rented_bike_count),\n      max_bikes = max(rented_bike_count)\n    )\n)\n\n# A tibble: 2 × 5\n  functioning_day count min_bikes mean_bikes max_bikes\n  &lt;fct&gt;           &lt;int&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;\n1 No                295         0         0          0\n2 Yes              8465         2       729.      3556\n\n# 6: Subset the data appropriately\nbike_data_functional &lt;- bike_data_cleaned |&gt;\n  filter(functioning_day == \"Yes\")\n\nsummary(bike_data_functional)\n\n      date            rented_bike_count      hour       temperature_c   \n Min.   :2017-12-01   Min.   :   2.0    Min.   : 0.00   Min.   :-17.80  \n 1st Qu.:2018-02-27   1st Qu.: 214.0    1st Qu.: 6.00   1st Qu.:  3.00  \n Median :2018-05-28   Median : 542.0    Median :12.00   Median : 13.50  \n Mean   :2018-05-28   Mean   : 729.2    Mean   :11.51   Mean   : 12.77  \n 3rd Qu.:2018-08-24   3rd Qu.:1084.0    3rd Qu.:18.00   3rd Qu.: 22.70  \n Max.   :2018-11-30   Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n humidity_percent wind_speed_m_s  visibility_10m dew_point_temperature_c\n Min.   : 0.00    Min.   :0.000   Min.   :  27   Min.   :-30.600        \n 1st Qu.:42.00    1st Qu.:0.900   1st Qu.: 935   1st Qu.: -5.100        \n Median :57.00    Median :1.500   Median :1690   Median :  4.700        \n Mean   :58.15    Mean   :1.726   Mean   :1434   Mean   :  3.945        \n 3rd Qu.:74.00    3rd Qu.:2.300   3rd Qu.:2000   3rd Qu.: 15.200        \n Max.   :98.00    Max.   :7.400   Max.   :2000   Max.   : 27.200        \n solar_radiation_mj_m2  rainfall_mm       snowfall_cm        seasons    \n Min.   :0.0000        Min.   : 0.0000   Min.   :0.00000   Autumn:1937  \n 1st Qu.:0.0000        1st Qu.: 0.0000   1st Qu.:0.00000   Spring:2160  \n Median :0.0100        Median : 0.0000   Median :0.00000   Summer:2208  \n Mean   :0.5679        Mean   : 0.1491   Mean   :0.07768   Winter:2160  \n 3rd Qu.:0.9300        3rd Qu.: 0.0000   3rd Qu.:0.00000                \n Max.   :3.5200        Max.   :35.0000   Max.   :8.80000                \n       holiday     functioning_day\n Holiday   : 408   No :   0       \n No Holiday:8057   Yes:8465       \n                                  \n                                  \n                                  \n                                  \n\nbike_data_functional_no &lt;- bike_data_cleaned |&gt;\n  filter(functioning_day == \"No\")\n\nsummary(bike_data_functional_no)\n\n      date            rented_bike_count      hour      temperature_c  \n Min.   :2018-04-11   Min.   :0         Min.   : 0.0   Min.   : 5.20  \n 1st Qu.:2018-09-19   1st Qu.:0         1st Qu.: 5.0   1st Qu.:12.30  \n Median :2018-10-02   Median :0         Median :11.0   Median :16.30  \n Mean   :2018-09-12   Mean   :0         Mean   :11.3   Mean   :16.09  \n 3rd Qu.:2018-10-09   3rd Qu.:0         3rd Qu.:17.0   3rd Qu.:19.35  \n Max.   :2018-11-09   Max.   :0         Max.   :23.0   Max.   :26.50  \n humidity_percent wind_speed_m_s  visibility_10m dew_point_temperature_c\n Min.   :21.00    Min.   :0.000   Min.   : 201   Min.   :-7.00          \n 1st Qu.:49.00    1st Qu.:0.900   1st Qu.:1055   1st Qu.: 5.30          \n Median :62.00    Median :1.500   Median :1814   Median : 7.80          \n Mean   :60.49    Mean   :1.697   Mean   :1522   Mean   : 7.77          \n 3rd Qu.:73.00    3rd Qu.:2.350   3rd Qu.:2000   3rd Qu.:11.00          \n Max.   :96.00    Max.   :5.300   Max.   :2000   Max.   :16.10          \n solar_radiation_mj_m2  rainfall_mm       snowfall_cm   seasons   \n Min.   :0.0000        Min.   : 0.0000   Min.   :0    Autumn:247  \n 1st Qu.:0.0000        1st Qu.: 0.0000   1st Qu.:0    Spring: 48  \n Median :0.0000        Median : 0.0000   Median :0    Summer:  0  \n Mean   :0.6048        Mean   : 0.1363   Mean   :0    Winter:  0  \n 3rd Qu.:1.0650        3rd Qu.: 0.0000   3rd Qu.:0                \n Max.   :3.3200        Max.   :18.0000   Max.   :0                \n       holiday    functioning_day\n Holiday   : 24   No :295        \n No Holiday:271   Yes:  0        \n                                 \n                                 \n                                 \n                                 \n\n\nIf the bike is not functioning, the rented bike count is always 0.\nSo we will focus on the data where the bike is functioning for further analysis.\n\n# 7: To simplify our analysis, we’ll summarize across the hours\nbike_data_daily &lt;- bike_data_functional |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(\n    # Find the sum of rented_bike_count, rainfall, and snowfall\n    rented_bike_count_sum = sum(rented_bike_count),\n    rainfall_sum_mm = sum(rainfall_mm),\n    snowfall_sum_cm = sum(snowfall_cm),\n    \n    # Find the mean of all the weather related variables\n    temperature_mean_c = mean(temperature_c),\n    humidity_mean_percent = mean(humidity_percent),\n    wind_speed_mean_m_s = mean(wind_speed_m_s),\n    visibility_mean_10m = mean(visibility_10m),\n    dew_point_temperature_mean_c = mean(dew_point_temperature_c),\n    solar_radiation_mean_mj_m2 = mean(solar_radiation_mj_m2),\n    \n    .groups = 'drop' \n  )\n\nglimpse(bike_data_daily)\n\nRows: 353\nColumns: 12\n$ date                         &lt;date&gt; 2017-12-01, 2017-12-02, 2017-12-03, 2017…\n$ seasons                      &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, W…\n$ holiday                      &lt;fct&gt; No Holiday, No Holiday, No Holiday, No Ho…\n$ rented_bike_count_sum        &lt;dbl&gt; 9539, 8523, 7222, 8729, 8307, 6669, 8549,…\n$ rainfall_sum_mm              &lt;dbl&gt; 0.0, 0.0, 4.0, 0.1, 0.0, 1.3, 0.0, 0.0, 0…\n$ snowfall_sum_cm              &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 8.6, 10.4, 0.0, …\n$ temperature_mean_c           &lt;dbl&gt; -2.45416667, 1.32500000, 4.87500000, -0.3…\n$ humidity_mean_percent        &lt;dbl&gt; 45.87500, 61.95833, 81.54167, 52.50000, 3…\n$ wind_speed_mean_m_s          &lt;dbl&gt; 1.5375000, 1.7125000, 1.6125000, 3.450000…\n$ visibility_mean_10m          &lt;dbl&gt; 1870.7500, 1471.0833, 455.7500, 1362.8333…\n$ dew_point_temperature_mean_c &lt;dbl&gt; -13.5458333, -5.7166667, 1.8833333, -9.92…\n$ solar_radiation_mean_mj_m2   &lt;dbl&gt; 0.24875000, 0.26375000, 0.12541667, 0.282…\n\n\n\n# 8: Recreate my basic summary stats\nsummary(bike_data_daily)\n\n      date              seasons         holiday    rented_bike_count_sum\n Min.   :2017-12-01   Autumn:81   Holiday   : 17   Min.   :  977        \n 1st Qu.:2018-02-27   Spring:90   No Holiday:336   1st Qu.: 6967        \n Median :2018-05-28   Summer:92                    Median :18563        \n Mean   :2018-05-28   Winter:90                    Mean   :17485        \n 3rd Qu.:2018-08-24                                3rd Qu.:26285        \n Max.   :2018-11-30                                Max.   :36149        \n rainfall_sum_mm  snowfall_sum_cm  temperature_mean_c humidity_mean_percent\n Min.   : 0.000   Min.   : 0.000   Min.   :-14.738    Min.   :22.25        \n 1st Qu.: 0.000   1st Qu.: 0.000   1st Qu.:  3.304    1st Qu.:47.58        \n Median : 0.000   Median : 0.000   Median : 13.738    Median :57.17        \n Mean   : 3.576   Mean   : 1.863   Mean   : 12.776    Mean   :58.17        \n 3rd Qu.: 0.500   3rd Qu.: 0.000   3rd Qu.: 22.592    3rd Qu.:67.71        \n Max.   :95.500   Max.   :78.700   Max.   : 33.742    Max.   :95.88        \n wind_speed_mean_m_s visibility_mean_10m dew_point_temperature_mean_c\n Min.   :0.6625      Min.   : 214.3      Min.   :-27.750             \n 1st Qu.:1.3042      1st Qu.:1087.0      1st Qu.: -5.188             \n Median :1.6583      Median :1557.8      Median :  4.612             \n Mean   :1.7261      Mean   :1434.0      Mean   :  3.954             \n 3rd Qu.:1.9542      3rd Qu.:1874.3      3rd Qu.: 14.921             \n Max.   :4.0000      Max.   :2000.0      Max.   : 25.038             \n solar_radiation_mean_mj_m2\n Min.   :0.02917           \n 1st Qu.:0.28333           \n Median :0.56500           \n Mean   :0.56773           \n 3rd Qu.:0.82000           \n Max.   :1.21667           \n\n# Plot: Rented Bike Count vs. Mean Temperature\nplot_temp &lt;- bike_data_daily |&gt;\n  ggplot(aes(x = temperature_mean_c , y = rented_bike_count_sum)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n  labs(\n    title = \"Daily Bike Rentals vs. Mean Temperature\",\n    x = \"Mean Temperature (C)\",\n    y = \"Sum of Daily Bike Rentals\"\n  )\nprint(plot_temp)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n#  correlation between my numeric variables\ncor_matrix &lt;- bike_data_daily |&gt;\n  select(where(is.numeric)) |&gt;\n  cor()\nprint(round(cor_matrix, 2))\n\n                             rented_bike_count_sum rainfall_sum_mm\nrented_bike_count_sum                         1.00           -0.24\nrainfall_sum_mm                              -0.24            1.00\nsnowfall_sum_cm                              -0.27           -0.02\ntemperature_mean_c                            0.75            0.14\nhumidity_mean_percent                         0.04            0.53\nwind_speed_mean_m_s                          -0.19           -0.10\nvisibility_mean_10m                           0.17           -0.22\ndew_point_temperature_mean_c                  0.65            0.26\nsolar_radiation_mean_mj_m2                    0.74           -0.32\n                             snowfall_sum_cm temperature_mean_c\nrented_bike_count_sum                  -0.27               0.75\nrainfall_sum_mm                        -0.02               0.14\nsnowfall_sum_cm                         1.00              -0.27\ntemperature_mean_c                     -0.27               1.00\nhumidity_mean_percent                   0.07               0.40\nwind_speed_mean_m_s                     0.02              -0.26\nvisibility_mean_10m                    -0.10               0.00\ndew_point_temperature_mean_c           -0.21               0.96\nsolar_radiation_mean_mj_m2             -0.23               0.55\n                             humidity_mean_percent wind_speed_mean_m_s\nrented_bike_count_sum                         0.04               -0.19\nrainfall_sum_mm                               0.53               -0.10\nsnowfall_sum_cm                               0.07                0.02\ntemperature_mean_c                            0.40               -0.26\nhumidity_mean_percent                         1.00               -0.23\nwind_speed_mean_m_s                          -0.23                1.00\nvisibility_mean_10m                          -0.56                0.21\ndew_point_temperature_mean_c                  0.63               -0.29\nsolar_radiation_mean_mj_m2                   -0.27                0.10\n                             visibility_mean_10m dew_point_temperature_mean_c\nrented_bike_count_sum                       0.17                         0.65\nrainfall_sum_mm                            -0.22                         0.26\nsnowfall_sum_cm                            -0.10                        -0.21\ntemperature_mean_c                          0.00                         0.96\nhumidity_mean_percent                      -0.56                         0.63\nwind_speed_mean_m_s                         0.21                        -0.29\nvisibility_mean_10m                         1.00                        -0.15\ndew_point_temperature_mean_c               -0.15                         1.00\nsolar_radiation_mean_mj_m2                  0.27                         0.38\n                             solar_radiation_mean_mj_m2\nrented_bike_count_sum                              0.74\nrainfall_sum_mm                                   -0.32\nsnowfall_sum_cm                                   -0.23\ntemperature_mean_c                                 0.55\nhumidity_mean_percent                             -0.27\nwind_speed_mean_m_s                                0.10\nvisibility_mean_10m                                0.27\ndew_point_temperature_mean_c                       0.38\nsolar_radiation_mean_mj_m2                         1.00"
  },
  {
    "objectID": "Homework8.html#split-the-data",
    "href": "Homework8.html#split-the-data",
    "title": "ST558 Homework8",
    "section": "",
    "text": "set.seed(10)\nbike_split &lt;- initial_split(bike_data_daily, prop = 0.75, strata = seasons)\nbike_train &lt;- training(bike_split)\nbike_test &lt;- testing(bike_split)\nbike_CV_folds &lt;- vfold_cv(bike_train, v = 10, strata = seasons)"
  },
  {
    "objectID": "Homework8.html#fitting-mlr-models",
    "href": "Homework8.html#fitting-mlr-models",
    "title": "ST558 Homework8",
    "section": "",
    "text": "Create some recipes.\n\nMLR_recipe1 &lt;- recipe(rented_bike_count_sum ~ ., data = bike_train) |&gt;\n  # Ignore the date variable for modeling\n  step_date(date, features = c(\"dow\")) |&gt;\n  step_mutate(day_type = factor(if_else(date_dow %in% c(\"Sat\", \"Sun\"), \n                                        \"weekend\", \"weekday\"))) |&gt;\n  step_rm(date, date_dow) |&gt; \n  # Standardize the numeric variables since their scales are pretty different.\n  step_normalize(all_numeric_predictors()) |&gt;\n  # Create dummy variables for the seasons, holiday, and our new day type variable\n  step_dummy(all_nominal_predictors())\n\n# recipe 2: 1.Do the same steps as above.\nMLR_recipe2 &lt;- MLR_recipe1 |&gt;\n  # Addin interactions between seasons and holiday, seasons and temp, temp and rainfall.\n  step_interact(~ starts_with(\"seasons_\"):starts_with(\"holiday_\")) |&gt;\n  step_interact(~ starts_with(\"seasons_\"):temperature_mean_c) |&gt;\n  step_interact(~ temperature_mean_c:rainfall_sum_mm)\n\n# recipe 3: 1.Do the same steps as the 2nd recipe.\nMLR_recipe3 &lt;- MLR_recipe2 |&gt;\n  # Add in quadratic terms for each numeric predictor\n  step_poly(\n    rainfall_sum_mm, snowfall_sum_cm, temperature_mean_c, humidity_mean_percent,\n    wind_speed_mean_m_s, visibility_mean_10m, dew_point_temperature_mean_c,\n    solar_radiation_mean_mj_m2,\n    degree = 2\n  )\n\nSet up our linear model fit to use the “lm” engine.\n\nMLR_spec &lt;- linear_reg() |&gt;\n  set_engine(\"lm\") \n\n\nMLR_wkf1 &lt;- workflow() |&gt;\n  add_recipe(MLR_recipe1) |&gt;\n  add_model(MLR_spec)\nMLR_wkf2 &lt;- workflow() |&gt;\n  add_recipe(MLR_recipe2) |&gt;\n  add_model(MLR_spec)\nMLR_wkf3 &lt;- workflow() |&gt;\n  add_recipe(MLR_recipe3) |&gt;\n  add_model(MLR_spec)\n\nFit the models using 10 fold CV via fit_resamples()\n\nMLR_fit1 &lt;-  MLR_wkf1 |&gt;\n  fit_resamples(bike_CV_folds)\nMLR_fit2 &lt;- MLR_wkf2 |&gt;\n  fit_resamples(bike_CV_folds)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x2\n\n\nThere were issues with some computations   A: x3\n\n\nThere were issues with some computations   A: x4\n\n\n\n\nMLR_fit3 &lt;- MLR_wkf3 |&gt;\n  fit_resamples(bike_CV_folds)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x2\n\n\nThere were issues with some computations   A: x3\n\n\nThere were issues with some computations   A: x4\n\n\n\n\ncv_rmse_summary &lt;- rbind(\n    MLR_fit1 |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\"),\n    MLR_fit2 |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\"),\n    MLR_fit3 |&gt; collect_metrics() |&gt; filter(.metric == \"rmse\")\n  ) |&gt; \n  mutate(Model = c(\"Model 1\", \"Model 2\", \"Model 3\")) |&gt;\n  select(Model, mean, n, std_err)\n\n# Print the final RMSE summary\nprint(cv_rmse_summary)\n\n# A tibble: 3 × 4\n  Model    mean     n std_err\n  &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;\n1 Model 1 4356.    10    148.\n2 Model 2 3045.    10    342.\n3 Model 3 2988.    10    339.\n\n\nFrom CV results, Model 3 had the lowest RMSE (≈ 2987.662). So it is selected as the best model.\n\nlowest_rmse &lt;- MLR_wkf3\n\n# Obtain final model on the test set\nfinal_model &lt;- lowest_rmse |&gt;\n  last_fit(bike_split)\n\n# Compute the RMSE metric on the test set\ntest_set_metrics &lt;- final_model |&gt;\n  collect_metrics()\n\nprint(test_set_metrics)\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config        \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard   11843.    pre0_mod0_post0\n2 rsq     standard       0.464 pre0_mod0_post0\n\n\nObtain the final model coefficient table\n\n# coefficient table using extract_fit_parsnip() and tidy()\ncoefficient_table &lt;- final_model |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()\n  \n# Print the coefficient table\nprint(coefficient_table, n=40)\n\n# A tibble: 32 × 5\n   term                                    estimate std.error statistic  p.value\n   &lt;chr&gt;                                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)                               15758.     1618.     9.74  5.36e-19\n 2 seasons_Spring                           -38052.    12303.    -3.09  2.23e- 3\n 3 seasons_Summer                            20237.     7345.     2.76  6.34e- 3\n 4 seasons_Winter                             6924.     6961.     0.995 3.21e- 1\n 5 holiday_No.Holiday                         5596.     1464.     3.82  1.70e- 4\n 6 day_type_weekend                          -2457.      389.    -6.31  1.37e- 9\n 7 seasons_Spring_x_holiday_No.Holiday       34072.    12319.     2.77  6.14e- 3\n 8 seasons_Summer_x_holiday_No.Holiday       -3743.     7256.    -0.516 6.06e- 1\n 9 seasons_Winter_x_holiday_No.Holiday      -18636.     6872.    -2.71  7.19e- 3\n10 seasons_Spring_x_temperature_mean_c       71162.    22145.     3.21  1.50e- 3\n11 seasons_Summer_x_temperature_mean_c      -17542.     5893.    -2.98  3.22e- 3\n12 seasons_Winter_x_temperature_mean_c        7070.     6282.     1.13  2.62e- 1\n13 seasons_Spring_x_holiday_No.Holiday_x_…  -65517.    22173.    -2.95  3.45e- 3\n14 seasons_Summer_x_holiday_No.Holiday_x_…    1638.     5555.     0.295 7.68e- 1\n15 seasons_Winter_x_holiday_No.Holiday_x_…  -13176.     5902.    -2.23  2.65e- 2\n16 temperature_mean_c_x_rainfall_sum_mm      -1596.      438.    -3.64  3.35e- 4\n17 rainfall_sum_mm_poly_1                   -23034.     5798.    -3.97  9.49e- 5\n18 rainfall_sum_mm_poly_2                     7002.     3105.     2.25  2.51e- 2\n19 snowfall_sum_cm_poly_1                    -2769.     3230.    -0.857 3.92e- 1\n20 snowfall_sum_cm_poly_2                     -491.     3012.    -0.163 8.71e- 1\n21 temperature_mean_c_poly_1                -11324.    66355.    -0.171 8.65e- 1\n22 temperature_mean_c_poly_2                -25949.    17339.    -1.50  1.36e- 1\n23 humidity_mean_percent_poly_1             -44599.    23294.    -1.91  5.68e- 2\n24 humidity_mean_percent_poly_2              -4353.     5925.    -0.735 4.63e- 1\n25 wind_speed_mean_m_s_poly_1                -7337.     3370.    -2.18  3.05e- 2\n26 wind_speed_mean_m_s_poly_2                 4213.     3081.     1.37  1.73e- 1\n27 visibility_mean_10m_poly_1                 7010.     4461.     1.57  1.17e- 1\n28 visibility_mean_10m_poly_2                -2906.     3147.    -0.923 3.57e- 1\n29 dew_point_temperature_mean_c_poly_1      125266.    76884.     1.63  1.05e- 1\n30 dew_point_temperature_mean_c_poly_2       -2844.    11553.    -0.246 8.06e- 1\n31 solar_radiation_mean_mj_m2_poly_1         44949.     5907.     7.61  6.96e-13\n32 solar_radiation_mean_mj_m2_poly_2         -9924.     3467.    -2.86  4.59e- 3"
  }
]